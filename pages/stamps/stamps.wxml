<!--pages/stamps/stamps.wxml-->
<view class="container">
  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="statistics-section">
    <view class="statistics-title">æ”¶é›†è¿›åº¦</view>
    <view class="statistics-content">
      <view class="stat-item">
        <view class="stat-number">{{statistics.completed}}</view>
        <view class="stat-label">å·²æ”¶é›†</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number">{{statistics.remaining}}</view>
        <view class="stat-label">å¾…æ”¶é›†</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number">{{statistics.completionRate}}%</view>
        <view class="stat-label">å®Œæˆç‡</view>
      </view>
    </view>
    
    <!-- è¿›åº¦æ¡ -->
    <view class="progress-bar">
      <view 
        class="progress-fill" 
        style="width: {{statistics.completionRate}}%">
      </view>
    </view>
  </view>

  <!-- å°ç« å±•ç¤º -->
  <view class="stamps-section">
    <view class="stamps-title">ç”µå­å°ç« </view>
    <view class="stamps-grid">
      <view 
        class="stamp-item {{item.isCompleted ? 'completed' : 'pending'}}"
        wx:for="{{stamps}}" 
        wx:key="id"
        bindtap="onStampTap"
        data-stamp-id="{{item.id}}">
        
        <!-- å°ç« å›¾æ ‡ -->
        <view class="stamp-icon">
          <image 
            src="{{item.isCompleted ? item.stampImage : '/images/stamps/placeholder.png'}}" 
            class="stamp-image">
          </image>
          <view class="stamp-status {{item.isCompleted ? 'completed' : 'pending'}}">
            {{item.isCompleted ? 'âœ“' : 'â—‹'}}
          </view>
        </view>
        
        <!-- å°ç« ä¿¡æ¯ -->
        <view class="stamp-info">
          <view class="stamp-name">{{item.name}}</view>
          <view class="stamp-area">{{item.area}}</view>
          <view class="stamp-time" wx:if="{{item.isCompleted}}">
            {{item.completionTime}}
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <button class="action-btn btn-primary" bindtap="viewCompletionStatus">
      {{userProgress.completionStatus ? 'æŸ¥çœ‹å¥–å“ä¿¡æ¯' : 'æŸ¥çœ‹å®Œæˆæƒ…å†µ'}}
    </button>
    <view class="action-row">
      <button class="action-btn btn-secondary" bindtap="goToMap">
        æŸ¥çœ‹åœ°å›¾
      </button>
      <button class="action-btn btn-success" bindtap="goToScan">
        ç»§ç»­æ‰“å¡
      </button>
    </view>
    <button class="action-btn btn-warning" bindtap="resetProgress">
      é‡ç½®è¿›åº¦
    </button>
  </view>

  <!-- å®Œæˆæç¤º -->
  <view class="completion-section" wx:if="{{userProgress.completionStatus}}">
    <view class="completion-title">ğŸ‰ æ­å–œå®Œæˆï¼</view>
    <view class="completion-content">
      æ‚¨å·²æˆåŠŸé›†é½æ‰€æœ‰ç”µå­å°ç« ï¼<br/>
      è¯·å‰å¾€ç­¾åˆ°å¤„ï¼ˆæ‰‹å·¥åŒºï¼‰é¢†å–ç²¾ç¾å¥–å“ã€‚
    </view>
    <view class="completion-tips">
      <view class="tip-item">ğŸ† å¥–å“ä¸°åšï¼Œä¸å®¹é”™è¿‡</view>
      <view class="tip-item">ğŸ“ ç­¾åˆ°å¤„ï¼šæ‰‹å·¥åŒº</view>
      <view class="tip-item">â° æ´»åŠ¨æœŸé—´æœ‰æ•ˆ</view>
    </view>
  </view>

  <!-- å°ç« åŠ¨ç”» -->
  <view class="stamp-animation" wx:if="{{showAnimation}}">
    <view class="animation-stamp">
      <image src="{{animationStamp.stampImage}}" class="animation-image"></image>
      <view class="animation-text">+1</view>
    </view>
  </view>
</view>