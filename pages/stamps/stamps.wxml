<!--pages/stamps/stamps.wxml-->
<view class="container" style="padding-top: {{navBarHeight}}px;">
  <!-- 自定义导航栏 -->
  <view class="custom-navbar" style="padding-top: {{statusBarHeight}}px; height: {{navBarHeight}}px;">
    <text class="nav-title">我的印章</text>
  </view>

  <!-- 统计信息 -->
  <view class="statistics-section">
    <view class="section-title">收集进度</view>
    <view class="statistics-content">
      <view class="stat-item">
        <view class="stat-number">{{statistics.completed}}</view>
        <view class="stat-label">已收集</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number">{{statistics.remaining}}</view>
        <view class="stat-label">待收集</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number">{{statistics.completionRate}}%</view>
        <view class="stat-label">完成率</view>
      </view>
    </view>
    
    <!-- 进度条 -->
    <view class="progress-bar">
      <view 
        class="progress-fill" 
        style="width: {{statistics.completionRate}}%">
      </view>
    </view>
  </view>

  <!-- 印章展示 -->
  <view class="stamps-section">
    <view class="section-title">电子印章</view>
    <view class="stamps-grid">
      <view 
        class="stamp-item {{item.isCompleted ? 'completed' : 'pending'}}"
        wx:for="{{stamps}}" 
        wx:key="id"
        data-stamp-id="{{item.id}}">
        
        <!-- 印章图标 -->
        <view class="stamp-icon">
          <image src="{{item.stampImage}}" class="stamp-image" mode="aspectFit"></image>
          <view class="stamp-status {{item.isCompleted ? 'completed' : 'pending'}}">
             {{item.isCompleted ? '⭐' : '○'}}
           </view>
        </view>
        
        <!-- 印章信息 -->
        <view class="stamp-info">
          <view class="stamp-status-text {{item.isCompleted ? 'completed' : 'pending'}}">
            {{item.isCompleted ? '✓ 已完成' : '○ 待打卡'}}
          </view>
          <view class="stamp-area">{{item.area}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="action-section">
    <button class="action-btn btn-success" bindtap="goToScan">
      继续打卡
    </button>
  </view>

  <!-- 完成提示 -->
  <view class="completion-section" wx:if="{{userProgress.completionStatus}}">
    <view class="completion-content">
      您已成功集齐所有电子印章！<br/>
      请前往签到处（手工区）领取精美奖品。
    </view>
    <view class="completion-tips">
      <view class="tip-item">🏆 奖品丰厚，不容错过</view>
      <view class="tip-item">📍 签到处：手工区</view>
      <view class="tip-item">⏰ 活动期间有效</view>
    </view>
  </view>

  <!-- 印章动画 -->
  <view class="stamp-animation" wx:if="{{showAnimation}}">
    <view class="animation-stamp">
      <image src="{{animationStamp.stampImage}}" class="animation-image"></image>
      <view class="animation-text">+1</view>
    </view>
  </view>
</view>