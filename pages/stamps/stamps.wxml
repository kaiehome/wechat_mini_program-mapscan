<!--pages/stamps/stamps.wxml-->
<view class="container" style="padding-top: {{navBarHeight}}px;">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar" style="padding-top: {{statusBarHeight}}px; height: {{navBarHeight}}px;">
    <text class="nav-title">æˆ‘çš„å°ç« </text>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="statistics-section">
    <view class="section-title">æ”¶é›†è¿›åº¦</view>
    <view class="statistics-content">
      <view class="stat-item">
        <view class="stat-number">{{statistics.completed}}</view>
        <view class="stat-label">å·²æ”¶é›†</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number">{{statistics.remaining}}</view>
        <view class="stat-label">å¾…æ”¶é›†</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number">{{statistics.completionRate}}%</view>
        <view class="stat-label">å®Œæˆç‡</view>
      </view>
    </view>
    
    <!-- è¿›åº¦æ¡ -->
    <view class="progress-bar">
      <view 
        class="progress-fill" 
        style="width: {{statistics.completionRate}}%">
      </view>
    </view>
  </view>

  <!-- å°ç« å±•ç¤º -->
  <view class="stamps-section">
    <view class="section-title">ç”µå­å°ç« </view>
    <view class="stamps-grid">
      <view 
        class="stamp-item {{item.isCompleted ? 'completed' : 'pending'}}"
        wx:for="{{stamps}}" 
        wx:key="id"
        data-stamp-id="{{item.id}}">
        
        <!-- å°ç« å›¾æ ‡ -->
        <view class="stamp-icon">
          <image src="{{item.stampImage}}" class="stamp-image" mode="aspectFit"></image>
          <view class="stamp-status {{item.isCompleted ? 'completed' : 'pending'}}">
             {{item.isCompleted ? 'â­' : 'â—‹'}}
           </view>
        </view>
        
        <!-- å°ç« ä¿¡æ¯ -->
        <view class="stamp-info">
          <view class="stamp-status-text {{item.isCompleted ? 'completed' : 'pending'}}">
            {{item.isCompleted ? 'âœ“ å·²å®Œæˆ' : 'â—‹ å¾…æ‰“å¡'}}
          </view>
          <view class="stamp-area">{{item.area}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <button class="action-btn btn-success" bindtap="goToScan">
      ç»§ç»­æ‰“å¡
    </button>
  </view>

  <!-- å®Œæˆæç¤º -->
  <view class="completion-section" wx:if="{{userProgress.completionStatus}}">
    <view class="completion-content">
      æ‚¨å·²æˆåŠŸé›†é½æ‰€æœ‰ç”µå­å°ç« ï¼<br/>
      è¯·å‰å¾€ç­¾åˆ°å¤„ï¼ˆæ‰‹å·¥åŒºï¼‰é¢†å–ç²¾ç¾å¥–å“ã€‚
    </view>
    <view class="completion-tips">
      <view class="tip-item">ğŸ† å¥–å“ä¸°åšï¼Œä¸å®¹é”™è¿‡</view>
      <view class="tip-item">ğŸ“ ç­¾åˆ°å¤„ï¼šæ‰‹å·¥åŒº</view>
      <view class="tip-item">â° æ´»åŠ¨æœŸé—´æœ‰æ•ˆ</view>
    </view>
  </view>

  <!-- å°ç« åŠ¨ç”» -->
  <view class="stamp-animation" wx:if="{{showAnimation}}">
    <view class="animation-stamp">
      <image src="{{animationStamp.stampImage}}" class="animation-image"></image>
      <view class="animation-text">+1</view>
    </view>
  </view>
</view>